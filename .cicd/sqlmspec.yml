version: 0.2

phases:
  install:
    commands:
      - git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap
      - cd sqlmap
      - pip install detect-secrets
  build:
    commands:
      - echo Start secret scan...
      - mkdir reports
      - python3 sqlmap.py -u https://36iqwlm5nj.execute-api.us-east-2.amazonaws.com/say --batch -v 0 --alert="CODEBUILD_BUILD_SUCCEEDING=0" > reports/sqlm-results.txt
  post_build:
    commands:
      - less reports/sqlm-results.txt
artifacts:
  files:
    - reports/sqlm-results.txt
